<script>
  import { fade, slide } from 'svelte/transition'
  import hosts from '../../stores/hosts'
  import * as actions from '$lib/actions'
  import TextField from '$lib/ui/TextField.svelte'
  import PrimaryButton from '$lib/ui/PrimaryButton.svelte'
  import _find from 'lodash-es/find.js'

  export let buttons = []

  let showingHosts = false
  let errorMessage = null
  let loading = false
  let width = 6

  let hostBeingConnected = null
  const availableHosts = [
    {
      id: 'vercel',
      svg: `<svg viewBox="0 0 284 65" fill="currentColor" style="width: ${width}rem;height: 100%;"
            ><title>Vercel  </title><path
              d="M141.68 16.25c-11.04 0-19 7.2-19 18s8.96 18 20 18c6.67 0 12.55-2.64 16.19-7.09l-7.65-4.42c-2.02 2.21-5.09 3.5-8.54 3.5-4.79 0-8.86-2.5-10.37-6.5h28.02c.22-1.12.35-2.28.35-3.5 0-10.79-7.96-17.99-19-17.99zm-9.46 14.5c1.25-3.99 4.67-6.5 9.45-6.5 4.79 0 8.21 2.51 9.45 6.5h-18.9zm117.14-14.5c-11.04 0-19 7.2-19 18s8.96 18 20 18c6.67 0 12.55-2.64 16.19-7.09l-7.65-4.42c-2.02 2.21-5.09 3.5-8.54 3.5-4.79 0-8.86-2.5-10.37-6.5h28.02c.22-1.12.35-2.28.35-3.5 0-10.79-7.96-17.99-19-17.99zm-9.45 14.5c1.25-3.99 4.67-6.5 9.45-6.5 4.79 0 8.21 2.51 9.45 6.5h-18.9zm-39.03 3.5c0 6 3.92 10 10 10 4.12 0 7.21-1.87 8.8-4.92l7.68 4.43c-3.18 5.3-9.14 8.49-16.48 8.49-11.05 0-19-7.2-19-18s7.96-18 19-18c7.34 0 13.29 3.19 16.48 8.49l-7.68 4.43c-1.59-3.05-4.68-4.92-8.8-4.92-6.07 0-10 4-10 10zm82.48-29v46h-9v-46h9zM37.59.25l36.95 64H.64l36.95-64zm92.38 5l-27.71 48-27.71-48h10.39l17.32 30 17.32-30h10.39zm58.91 12v9.69c-1-.29-2.06-.49-3.2-.49-5.81 0-10 4-10 10v14.8h-9v-34h9v9.2c0-5.08 5.91-9.2 13.2-9.2z"
            /></svg
          >`,
    },
    {
      id: 'netlify',
      svg: `<?xml version="1.0" encoding="UTF-8" standalone="no"?>
        <svg
          xmlns:dc="http://purl.org/dc/elements/1.1/"
          xmlns:cc="http://creativecommons.org/ns#"
          xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
          xmlns:svg="http://www.w3.org/2000/svg"
          xmlns="http://www.w3.org/2000/svg"
          xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
          xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
          width="120"
          height="60"
          viewBox="0 0 120 60"
          version="1.1"
          id="svg18"
          sodipodi:docname="netlify-ar21.svg"
          inkscape:version="0.92.4 (5da689c313, 2019-01-14)">  
          <title
          id="title2">Netlify</title>
          <defs
            id="defs11">
            <radialGradient
            cx="52.527786"
            cy="-49.920341"
            fx="52.527786"
            fy="-49.920341"
            r="104.61749"
            gradientTransform="matrix(0.32798653,0,0,0.32881934,6.7094059,12.101607)"
            id="radialGradient-1"
            gradientUnits="userSpaceOnUse">
            <stop
            stop-color="#20C6B7"
            offset="0%"
            id="stop6" />
            <stop
            stop-color="#4D9ABF"
            offset="100%"
            id="stop8" />
            </radialGradient>
          </defs>
          <g
            id="g836"
            transform="matrix(0.96976481,0,0,0.96976481,1.4142375,0.90705594)">
            <path
            style="fill:#0e1e25;fill-rule:nonzero;stroke:none;stroke-width:0.2506941"
            inkscape:connector-curvature="0"
            id="Shape"
            d="m 50.318924,25.028803 0.0839,1.501545 c 0.957072,-1.16134 2.213613,-1.74201 3.76894,-1.74201 2.695217,0 4.067043,1.549364 4.114792,4.648094 v 8.585721 h -2.906003 v -8.417668 c 0,-0.824552 -0.177364,-1.434597 -0.532086,-1.831503 -0.354724,-0.396222 -0.935244,-0.594333 -1.740875,-0.594333 -1.172634,0 -2.046483,0.532851 -2.619497,1.597185 v 9.246319 h -2.90737 v -12.99335 h 2.739558 z m 16.629715,13.233816 c -1.841834,0 -3.335766,-0.582036 -4.479748,-1.746793 -1.144667,-1.164756 -1.716999,-2.71617 -1.716999,-4.653559 v -0.360015 c 0,-1.296603 0.248987,-2.455894 0.747648,-3.476507 0.497976,-1.020613 1.198556,-1.815107 2.099691,-2.384164 0.901135,-0.56769 1.905957,-0.851877 3.01515,-0.851877 1.762021,0 3.124296,0.564275 4.08478,1.692824 0.961845,1.129233 1.442088,2.725735 1.442088,4.791554 v 1.177053 h -8.458795 c 0.08868,1.072532 0.444769,1.920994 1.070992,2.545385 0.626224,0.624391 1.414121,0.936587 2.363005,0.936587 1.33158,0 2.416215,-0.539682 3.253907,-1.621095 l 1.566923,1.501545 c -0.51844,0.776049 -1.210153,1.378579 -2.075133,1.806909 -0.865661,0.42833 -1.836377,0.642153 -2.912827,0.642153 z M 66.602102,27.131513 c -0.798127,0 -1.441406,0.280088 -1.931879,0.840264 -0.491157,0.560176 -0.803584,1.341006 -0.939335,2.341808 h 5.539146 V 30.09703 c -0.06412,-0.976893 -0.323345,-1.714685 -0.777663,-2.215428 -0.455002,-0.50006 -1.084636,-0.750089 -1.890269,-0.750089 z m 11.436427,-5.260189 v 3.158163 h 2.285237 v 2.161459 h -2.285237 v 7.252912 c 0,0.495961 0.09823,0.853927 0.29333,1.074582 0.195097,0.219971 0.544362,0.329957 1.047116,0.329957 0.342285,-9.52e-4 0.68333,-0.0413 1.016419,-0.120233 v 2.257783 c -0.661697,0.184448 -1.299518,0.275989 -1.914142,0.275989 -2.232714,0 -3.349411,-1.236486 -3.349411,-3.710141 v -7.361532 h -2.13107 v -2.16146 h 2.129706 v -3.158162 h 2.906688 z m 7.597224,16.151512 H 82.728384 V 19.578018 h 2.907369 z m 6.256779,0 h -2.90737 V 25.029487 h 2.90737 z M 88.805755,21.654768 c 0,-0.447458 0.141206,-0.81977 0.424303,-1.116253 0.28378,-0.2958 0.6883,-0.444042 1.214246,-0.444042 0.526629,0 0.933197,0.148242 1.221069,0.444042 0.286508,0.296483 0.429762,0.668795 0.429762,1.116936 0,0.439943 -0.143254,0.806107 -0.429762,1.098491 -0.287872,0.292385 -0.69444,0.438577 -1.221069,0.438577 -0.525946,0 -0.930466,-0.146192 -1.214246,-0.438577 -0.283097,-0.291701 -0.424303,-0.658548 -0.424303,-1.098491 z m 7.27388,16.368068 V 27.190263 h -1.974174 v -2.16146 h 1.974174 v -1.188666 c 0,-1.441428 0.398383,-2.553582 1.195828,-3.338512 0.79813,-0.784246 1.914145,-1.176369 3.349407,-1.176369 0.51094,0 1.05326,0.07173 1.62764,0.215872 l -0.0716,2.281693 c -0.36686,-0.06819 -0.73951,-0.100221 -1.1126,-0.09564 -1.388199,0 -2.081958,0.715932 -2.081958,2.149163 v 1.152459 h 2.631778 v 2.16146 h -2.631778 v 10.83189 h -2.906687 z m 12.190215,-4.178776 2.63177,-8.814573 H 114 l -5.14349,14.962846 c -0.78994,2.185371 -2.12971,3.278395 -4.01998,3.278395 -0.42294,0 -0.88953,-0.07241 -1.39979,-0.216555 v -2.257782 l 0.5505,0.03621 c 0.73333,0 1.28588,-0.133896 1.65697,-0.40237 0.37042,-0.267792 0.66374,-0.717982 0.87931,-1.350571 l 0.41816,-1.116936 -4.54592,-12.933233 h 3.13453 z" />
            <path
            style="fill:url(#radialGradient-1);fill-rule:nonzero;stroke:none;stroke-width:0.32840267"
            inkscape:connector-curvature="0"
            id="path14"
              d="m 31.629584,24.750981 -0.01245,-0.0053 c -0.0072,-0.0028 -0.01431,-0.0053 -0.02056,-0.01167 -0.02078,-0.02234 -0.03002,-0.05309 -0.02502,-0.08323 l 0.690763,-4.229284 3.239345,3.244897 -3.368919,1.435414 c -0.0092,0.0038 -0.0194,0.0057 -0.02949,0.0053 h -0.0134 c -0.0044,-0.0028 -0.0089,-0.0063 -0.01786,-0.01521 -0.125378,-0.139797 -0.275305,-0.255362 -0.442339,-0.340956 z m 4.698615,-0.257731 3.463645,3.468621 c 0.719356,0.721288 1.079483,1.081037 1.210845,1.498059 0.01967,0.06176 0.03574,0.123492 0.04826,0.187034 l -8.277537,-3.510682 c -0.0044,-0.0019 -0.0089,-0.0037 -0.0134,-0.0053 -0.03306,-0.01342 -0.07149,-0.02863 -0.07149,-0.06264 0,-0.03401 0.03931,-0.05012 0.07237,-0.06353 l 0.01074,-0.0044 z m 4.581555,6.266966 c -0.178724,0.336482 -0.527235,0.685491 -1.117017,1.277018 l -3.905089,3.909806 -5.050698,-1.053293 -0.0268,-0.0053 c -0.04469,-0.0072 -0.09204,-0.01521 -0.09204,-0.05548 -0.03878,-0.421772 -0.250773,-0.808459 -0.585315,-1.067611 -0.02056,-0.02058 -0.0152,-0.0528 -0.0089,-0.08233 0,-0.0044 0,-0.0089 0.0018,-0.01258 l 0.949909,-5.8401 0.0035,-0.01969 c 0.0053,-0.04475 0.0134,-0.09665 0.05362,-0.09665 0.411209,-0.05123 0.784668,-0.265629 1.036592,-0.595106 0.008,-0.0089 0.0134,-0.0188 0.02413,-0.02417 0.02859,-0.01343 0.06255,0 0.09204,0.01258 l 8.623365,3.652971 z m -5.920187,6.086196 -6.4215,6.430732 1.099144,-6.765422 0.0018,-0.0089 c 8.87e-4,-0.0089 0.0028,-0.01789 0.0053,-0.02595 0.0089,-0.02148 0.03217,-0.03043 0.05451,-0.03938 l 0.01074,-0.0044 c 0.240665,-0.102833 0.453518,-0.261397 0.621061,-0.462662 0.02145,-0.02506 0.04736,-0.04922 0.08042,-0.0537 0.0086,-0.0014 0.01733,-0.0014 0.02591,0 l 4.52168,0.930693 z m -7.780686,7.791871 -0.723825,0.724867 -8.002303,-11.581761 c -0.0029,-0.0042 -0.0059,-0.0084 -0.0089,-0.01258 -0.01245,-0.01701 -0.02591,-0.03401 -0.02324,-0.0537 0,-0.01432 0.0099,-0.02684 0.01966,-0.03758 l 0.0089,-0.01165 c 0.02413,-0.03581 0.04469,-0.07159 0.06702,-0.110077 l 0.01787,-0.03133 0.0028,-0.0028 c 0.01258,-0.02148 0.02413,-0.04207 0.04557,-0.0537 0.01876,-0.0089 0.04469,-0.0053 0.06524,-8.87e-4 l 8.865532,1.830962 c 0.02479,0.0038 0.04817,0.01403 0.06791,0.02953 0.01165,0.01166 0.01431,0.02417 0.01698,0.03849 0.125351,0.474977 0.465199,0.863975 0.918634,1.051504 0.02502,0.01258 0.01431,0.04027 0.0028,0.0698 -0.0058,0.01297 -0.01035,0.02643 -0.0134,0.04027 -0.111702,0.680121 -1.069654,6.53096 -1.327014,8.110454 z m -1.511992,1.513273 c -0.533486,0.528883 -0.848039,0.808985 -1.203697,0.92174 -0.350674,0.111048 -0.727021,0.111048 -1.077697,0 -0.416423,-0.132444 -0.776548,-0.492192 -1.495907,-1.213476 l -8.03626,-8.047814 2.099098,-3.26011 c 0.0099,-0.01611 0.01966,-0.03043 0.03574,-0.04207 0.02233,-0.01611 0.05451,-0.0089 0.08132,0 0.4818,0.145566 0.999097,0.119314 1.463737,-0.07427 0.02413,-0.0089 0.04826,-0.01521 0.06702,0.0018 0.0095,0.0085 0.01778,0.01818 0.02502,0.02863 l 8.041621,11.68648 z m -12.588322,-9.115425 -1.843523,-1.846173 3.640578,-1.555332 c 0.0093,-0.0041 0.01933,-0.0062 0.02949,-0.0063 0.03038,0 0.04826,0.03043 0.06435,0.05816 0.03659,0.05637 0.07533,0.111296 0.116168,0.164661 l 0.01165,0.01432 c 0.01074,0.01521 0.0035,0.03043 -0.0072,0.04475 l -2.01063,3.125876 z M 10.449175,34.372917 8.1168455,32.037234 C 7.7200819,31.639901 7.4323383,31.351743 7.2321691,31.103856 l 7.0917099,1.473002 c 0.0089,0.0017 0.01784,0.0032 0.02681,0.0044 0.04379,0.0072 0.09203,0.01522 0.09203,0.05638 0,0.04475 -0.05272,0.06533 -0.09741,0.08233 l -0.02055,0.0089 z M 6.8246822,29.902904 c 0.00812,-0.15046 0.035107,-0.299295 0.080419,-0.442974 0.1322549,-0.417022 0.4914876,-0.776771 1.2117388,-1.498059 l 2.984666,-2.988955 c 1.374228,1.997303 2.752182,3.992032 4.133853,5.984177 0.02413,0.03221 0.05093,0.06802 0.02324,0.09486 -0.130473,0.144078 -0.260935,0.301579 -0.352978,0.472505 -0.01,0.02196 -0.02536,0.04106 -0.04469,0.05549 -0.01165,0.0072 -0.02413,0.0044 -0.03753,0.0018 h -0.0018 L 6.8246822,29.90201 Z m 5.0757188,-5.730026 4.011429,-4.018984 c 0.377997,0.165555 1.75148,0.746343 2.97841,1.265383 0.929357,0.393757 1.776503,0.751714 2.0428,0.868052 0.0268,0.01074 0.05093,0.02147 0.06255,0.04832 0.0072,0.01611 0.0035,0.03669 0,0.0537 -0.129046,0.589307 0.0466,1.204093 0.46736,1.635872 0.0268,0.02685 0,0.06532 -0.02324,0.09845 l -0.01245,0.0188 -4.074875,6.32066 c -0.01074,0.01789 -0.02055,0.03311 -0.03843,0.04475 -0.02145,0.01343 -0.05184,0.0072 -0.07685,8.87e-4 -0.158486,-0.04158 -0.321412,-0.06382 -0.485232,-0.06622 -0.146551,0 -0.305615,0.02685 -0.466465,0.05638 h -8.87e-4 c -0.01787,0.0028 -0.03396,0.0063 -0.04826,-0.0044 -0.0158,-0.01297 -0.02937,-0.02833 -0.04021,-0.04564 l -4.296498,-6.27591 z m 4.823723,-4.830656 5.195464,-5.202933 c 0.719359,-0.720393 1.079484,-1.081036 1.495907,-1.212587 0.350676,-0.111046 0.727023,-0.111046 1.077697,0 0.416424,0.131551 0.77655,0.492194 1.495909,1.212587 l 1.125951,1.12757 -3.695088,5.730922 c -0.0091,0.01668 -0.02161,0.0313 -0.03664,0.04295 -0.02234,0.01521 -0.05362,0.0089 -0.08043,0 -0.591442,-0.179744 -1.233349,-0.05587 -1.715737,0.331112 -0.02413,0.02506 -0.05986,0.01074 -0.09025,-0.0028 -0.48255,-0.2103 -4.235723,-1.798743 -4.772786,-2.026941 z m 11.17552,-3.289644 3.411814,3.416718 -0.822125,5.099125 v 0.01343 c -7.21e-4,0.01165 -0.0032,0.02307 -0.0072,0.03401 -0.0089,0.01789 -0.0268,0.02148 -0.04469,0.02685 -0.175774,0.05332 -0.341323,0.135909 -0.489699,0.244306 -0.0064,0.0046 -0.01231,0.0097 -0.01787,0.01521 -0.0099,0.01074 -0.01966,0.02057 -0.03574,0.02237 -0.0131,3.93e-4 -0.02614,-0.0017 -0.03843,-0.0063 l -5.199039,-2.212186 -0.0099,-0.0044 c -0.03306,-0.01342 -0.07239,-0.02954 -0.07239,-0.06353 -0.03056,-0.290139 -0.12518,-0.569838 -0.277019,-0.818831 -0.02503,-0.04116 -0.05272,-0.08413 -0.03129,-0.126176 z m -3.513685,7.701486 4.873764,2.067213 c 0.0268,0.01258 0.0563,0.02416 0.06791,0.0519 0.0047,0.01669 0.0047,0.03432 0,0.05101 -0.01431,0.07159 -0.0268,0.153029 -0.0268,0.235359 v 0.136919 c 0,0.03401 -0.03485,0.04832 -0.06702,0.06176 l -0.0099,0.0035 c -0.772082,0.330217 -10.839524,4.629304 -10.854716,4.629304 -0.01519,0 -0.03128,0 -0.04646,-0.01521 -0.0268,-0.02684 0,-0.06444 0.02413,-0.09845 0.0043,-0.0059 0.0084,-0.01192 0.01245,-0.01789 l 4.005172,-6.210587 0.0072,-0.01074 c 0.02324,-0.03758 0.05004,-0.07965 0.09293,-0.07965 l 0.04022,0.0063 c 0.09115,0.01258 0.171572,0.02415 0.252892,0.02415 0.607656,0 1.170633,-0.296209 1.510205,-0.802721 0.0081,-0.01354 0.01835,-0.02562 0.03038,-0.03581 0.02413,-0.01789 0.05987,-0.0089 0.08757,0.0035 z m -5.581504,8.219633 10.973562,-4.686577 c 0,0 0.01608,0 0.03128,0.01521 0.05987,0.05996 0.110811,0.100225 0.159956,0.137815 l 0.02413,0.01521 c 0.02233,0.01258 0.04469,0.02684 0.04646,0.05012 0,0.0089 0,0.01432 -0.0019,0.02237 l -0.940081,5.782824 -0.0035,0.02327 c -0.0063,0.04475 -0.01245,0.09576 -0.05451,0.09576 -0.508829,0.0344 -0.967933,0.318022 -1.226931,0.757978 l -0.0044,0.0072 c -0.01245,0.02059 -0.02413,0.04027 -0.04469,0.05101 -0.01876,0.0089 -0.04289,0.0053 -0.06255,8.87e-4 l -8.751149,-1.807692 c -0.0089,-0.0018 -0.135829,-0.464451 -0.145658,-0.465346 z" />
          </g>
          </svg>
          `,
    },
  ]

  const netlifyHostedSVG = `<svg width="120" height="60" xmlns="http://www.w3.org/2000/svg" xmlns:undefined="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:undefined="http://www.inkscape.org/namespaces/inkscape" version="1.1">
        <title id="title2">Netlify</title>
        
        <g>
                  <title>Layer 1</title>
                  <g transform="matrix(0.969765 0 0 0.969765 1.41424 0.907056)" id="g836">
                    <path stroke-width="0.25069" fill-rule="nonzero" fill="#ffffff" d="m50.31892,25.0288l0.0839,1.50155c0.95708,-1.16134 2.21362,-1.74201 3.76894,-1.74201c2.69522,0 4.06705,1.54936 4.1148,4.64809l0,8.58572l-2.90601,0l0,-8.41766c0,-0.82456 -0.17736,-1.4346 -0.53208,-1.83151c-0.35473,-0.39622 -0.93525,-0.59433 -1.74088,-0.59433c-1.17263,0 -2.04648,0.53285 -2.61949,1.59718l0,9.24632l-2.90737,0l0,-12.99335l2.73955,0l-0.00136,0zm16.62972,13.23382c-1.84184,0 -3.33577,-0.58204 -4.47975,-1.74679c-1.14467,-1.16476 -1.717,-2.71617 -1.717,-4.65356l0,-0.36002c0,-1.2966 0.24899,-2.45589 0.74765,-3.4765c0.49798,-1.02062 1.19856,-1.81511 2.09969,-2.38417c0.90114,-0.56769 1.90596,-0.85188 3.01515,-0.85188c1.76202,0 3.1243,0.56428 4.08478,1.69283c0.96185,1.12923 1.44209,2.72573 1.44209,4.79155l0,1.17706l-8.4588,0c0.08868,1.07253 0.44477,1.92099 1.071,2.54538c0.62622,0.62439 1.41412,0.93659 2.363,0.93659c1.33158,0 2.41622,-0.53968 3.25391,-1.6211l1.56692,1.50155c-0.51844,0.77605 -1.21015,1.37858 -2.07513,1.80691c-0.86566,0.42833 -1.83638,0.64215 -2.91283,0.64215l-0.00068,0zm-0.34654,-11.13111c-0.79812,0 -1.4414,0.28009 -1.93188,0.84027c-0.49115,0.56017 -0.80358,1.341 -0.93933,2.34181l5.53914,0l0,-0.21656c-0.06412,-0.97689 -0.32334,-1.71468 -0.77766,-2.21543c-0.455,-0.50006 -1.08463,-0.75009 -1.89027,-0.75009zm11.43643,-5.26019l0,3.15817l2.28524,0l0,2.16146l-2.28524,0l0,7.25291c0,0.49596 0.09823,0.85393 0.29333,1.07458c0.1951,0.21997 0.54436,0.32996 1.04711,0.32996c0.34229,-0.00095 0.68333,-0.0413 1.01642,-0.12024l0,2.25779c-0.66169,0.18445 -1.29951,0.27599 -1.91414,0.27599c-2.23271,0 -3.34941,-1.23649 -3.34941,-3.71014l0,-7.36154l-2.13107,0l0,-2.16146l2.12971,0l0,-3.15816l2.90669,0l0.00136,0.00068zm7.59722,16.15152l-2.90737,0l0,-18.44482l2.90737,0l0,18.44482zm6.25678,0l-2.90737,0l0,-12.99335l2.90737,0l0,12.99335zm-3.08677,-16.36807c0,-0.44746 0.1412,-0.81977 0.4243,-1.11625c0.28378,-0.2958 0.6883,-0.44405 1.21424,-0.44405c0.52663,0 0.9332,0.14825 1.22107,0.44405c0.28651,0.29648 0.42976,0.66879 0.42976,1.11693c0,0.43994 -0.14325,0.80611 -0.42976,1.09849c-0.28787,0.29239 -0.69444,0.43858 -1.22107,0.43858c-0.52594,0 -0.93046,-0.14619 -1.21424,-0.43858c-0.2831,-0.2917 -0.4243,-0.65855 -0.4243,-1.09849l0,-0.00068zm7.27388,16.36807l0,-10.83258l-1.97418,0l0,-2.16146l1.97418,0l0,-1.18866c0,-1.44143 0.39838,-2.55358 1.19582,-3.33851c0.79813,-0.78425 1.91415,-1.17637 3.34941,-1.17637c0.51094,0 1.05326,0.07173 1.62764,0.21587l-0.0716,2.28169c-0.36686,-0.06819 -0.73951,-0.10022 -1.1126,-0.09564c-1.3882,0 -2.08196,0.71593 -2.08196,2.14916l0,1.15246l2.63178,0l0,2.16146l-2.63178,0l0,10.83189l-2.90668,0l-0.00003,0.00069zm12.19021,-4.17878l2.63177,-8.81457l3.09838,0l-5.14349,14.96284c-0.78994,2.18537 -2.12971,3.2784 -4.01998,3.2784c-0.42294,0 -0.88953,-0.07241 -1.39979,-0.21656l0,-2.25778l0.5505,0.03621c0.73333,0 1.28588,-0.13389 1.65697,-0.40237c0.37042,-0.26779 0.66374,-0.71798 0.87931,-1.35057l0.41816,-1.11694l-4.54592,-12.93323l3.13453,0l2.73956,8.81457z" id="Shape" />
                    <path stroke-width="0.3284" fill-rule="nonzero" fill="#ffffff" d="m31.62958,24.75098l-0.01245,-0.0053c-0.0072,-0.0028 -0.01431,-0.0053 -0.02056,-0.01167c-0.02078,-0.02234 -0.03002,-0.05309 -0.02502,-0.08323l0.69077,-4.22928l3.23934,3.24489l-3.36892,1.43542c-0.0092,0.0038 -0.0194,0.0057 -0.02949,0.0053l-0.0134,0c-0.0044,-0.0028 -0.0089,-0.0063 -0.01786,-0.01521c-0.12538,-0.1398 -0.2753,-0.25536 -0.44234,-0.34096l-0.00007,0.00004zm4.69862,-0.25773l3.46364,3.46862c0.71936,0.72129 1.07949,1.08104 1.21085,1.49806c0.01967,0.06176 0.03574,0.12349 0.04826,0.18703l-8.27754,-3.51068c-0.0044,-0.0019 -0.0089,-0.0037 -0.0134,-0.0053c-0.03306,-0.01342 -0.07149,-0.02863 -0.07149,-0.06264c0,-0.03401 0.03931,-0.05012 0.07237,-0.06353l0.01074,-0.0044l3.55657,-1.50716zm4.58155,6.26697c-0.17872,0.33648 -0.52723,0.68549 -1.11701,1.27701l-3.90509,3.90981l-5.0507,-1.05329l-0.0268,-0.0053c-0.04469,-0.0072 -0.09204,-0.01521 -0.09204,-0.05548c-0.03878,-0.42177 -0.25077,-0.80846 -0.58532,-1.06761c-0.02056,-0.02058 -0.0152,-0.0528 -0.0089,-0.08233c0,-0.0044 0,-0.0089 0.0018,-0.01258l0.94991,-5.8401l0.0035,-0.01969c0.0053,-0.04475 0.0134,-0.09665 0.05362,-0.09665c0.41121,-0.05123 0.78467,-0.26563 1.0366,-0.59511c0.008,-0.0089 0.0134,-0.0188 0.02413,-0.02417c0.02859,-0.01343 0.06255,0 0.09204,0.01258l8.62336,3.65297l0.0009,-0.00006zm-5.92018,6.08619l-6.4215,6.43073l1.09914,-6.76542l0.0018,-0.0089c0.00089,-0.0089 0.0028,-0.01789 0.0053,-0.02595c0.0089,-0.02148 0.03217,-0.03043 0.05451,-0.03938l0.01074,-0.0044c0.24067,-0.10283 0.45352,-0.2614 0.62106,-0.46266c0.02145,-0.02506 0.04736,-0.04922 0.08042,-0.0537c0.0086,-0.0014 0.01733,-0.0014 0.02591,0l4.52168,0.93069l0.00094,-0.00101zm-7.78069,7.79187l-0.72382,0.72487l-8.00231,-11.58176c-0.0029,-0.0042 -0.0059,-0.0084 -0.0089,-0.01258c-0.01245,-0.01701 -0.02591,-0.03401 -0.02324,-0.0537c0,-0.01432 0.0099,-0.02684 0.01966,-0.03758l0.0089,-0.01165c0.02413,-0.03581 0.04469,-0.07159 0.06702,-0.11008l0.01787,-0.03133l0.0028,-0.0028c0.01258,-0.02148 0.02413,-0.04207 0.04557,-0.0537c0.01876,-0.0089 0.04469,-0.0053 0.06524,-0.00088l8.86554,1.83096c0.02478,0.0038 0.04816,0.01403 0.06791,0.02953c0.01165,0.01166 0.0143,0.02417 0.01698,0.03849c0.12535,0.47497 0.46519,0.86397 0.91863,1.0515c0.02502,0.01258 0.01431,0.04027 0.0028,0.0698c-0.0058,0.01297 -0.01035,0.02643 -0.0134,0.04027c-0.1117,0.68012 -1.06965,6.53096 -1.32701,8.11046l-0.00024,0.00018zm-1.51199,1.51328c-0.53349,0.52888 -0.84804,0.80898 -1.2037,0.92174c-0.35067,0.11104 -0.72702,0.11104 -1.0777,0c-0.41642,-0.13245 -0.77654,-0.4922 -1.4959,-1.21348l-8.03626,-8.04781l2.0991,-3.26011c0.0099,-0.01611 0.01966,-0.03043 0.03574,-0.04207c0.02233,-0.01611 0.05451,-0.0089 0.08132,0c0.4818,0.14556 0.99909,0.11931 1.46373,-0.07427c0.02413,-0.0089 0.04826,-0.01521 0.06702,0.0018c0.0095,0.0085 0.01778,0.01818 0.02502,0.02863l8.04162,11.68648l0.00001,-0.00091zm-12.58832,-9.11543l-1.84353,-1.84617l3.64058,-1.55533c0.0093,-0.0041 0.01933,-0.0062 0.02949,-0.0063c0.03038,0 0.04826,0.03043 0.06435,0.05816c0.03659,0.05637 0.07533,0.11129 0.11617,0.16466l0.01165,0.01432c0.01074,0.01521 0.0035,0.03043 -0.0072,0.04475l-2.01063,3.12587l-0.00088,0.00004zm-2.65939,-2.66321l-2.33233,-2.33569c-0.39677,-0.39733 -0.68451,-0.68549 -0.88468,-0.93337l7.09171,1.473c0.0089,0.0017 0.01784,0.0032 0.02681,0.0044c0.04379,0.0072 0.09203,0.01522 0.09203,0.05638c0,0.04475 -0.05272,0.06533 -0.09741,0.08233l-0.02055,0.0089l-3.87558,1.64405zm-3.6245,-4.47002c0.00812,-0.15046 0.03511,-0.29929 0.08042,-0.44297c0.13226,-0.41702 0.49149,-0.77677 1.21174,-1.49806l2.98467,-2.98895c1.37422,1.9973 2.75218,3.99203 4.13385,5.98417c0.02413,0.03221 0.05093,0.06802 0.02324,0.09486c-0.13047,0.14408 -0.26094,0.30158 -0.35298,0.47251c-0.01,0.02196 -0.02536,0.04106 -0.04469,0.05549c-0.01165,0.0072 -0.02413,0.0044 -0.03753,0.0018l-0.0018,0l-7.99692,-1.67974l0,0.00089zm5.07572,-5.73002l4.01143,-4.01899c0.378,0.16556 1.75148,0.74635 2.97841,1.26539c0.92936,0.39375 1.7765,0.75171 2.0428,0.86805c0.0268,0.01074 0.05093,0.02147 0.06255,0.04832c0.0072,0.01611 0.0035,0.03669 0,0.0537c-0.12905,0.58931 0.0466,1.20409 0.46736,1.63587c0.0268,0.02685 0,0.06532 -0.02324,0.09845l-0.01245,0.0188l-4.07488,6.32066c-0.01074,0.01789 -0.02055,0.03311 -0.03843,0.04475c-0.02145,0.01343 -0.05184,0.0072 -0.07685,0.00089c-0.15848,-0.04158 -0.32141,-0.06382 -0.48523,-0.06622c-0.14655,0 -0.30561,0.02685 -0.46646,0.05638l-0.00089,0c-0.01787,0.0028 -0.03396,0.0063 -0.04826,-0.0044c-0.0158,-0.01297 -0.02937,-0.02833 -0.04021,-0.04564l-4.2965,-6.27591l0.00085,-0.0001zm4.82372,-4.83066l5.19547,-5.20293c0.71936,-0.72039 1.07948,-1.08104 1.4959,-1.21259c0.35068,-0.11104 0.72703,-0.11104 1.0777,0c0.41643,0.13155 0.77655,0.4922 1.49591,1.21259l1.12595,1.12757l-3.69509,5.73092c-0.0091,0.01668 -0.02161,0.0313 -0.03664,0.04295c-0.02234,0.01521 -0.05362,0.0089 -0.08043,0c-0.59144,-0.17974 -1.23334,-0.05587 -1.71573,0.33111c-0.02413,0.02506 -0.05986,0.01074 -0.09025,-0.0028c-0.48255,-0.2103 -4.23573,-1.79874 -4.77279,-2.02694l0,0.00012zm11.17552,-3.28964l3.41182,3.41672l-0.82213,5.09912l0,0.01343c-0.00072,0.01165 -0.0032,0.02307 -0.0072,0.03401c-0.0089,0.01789 -0.0268,0.02148 -0.04469,0.02685c-0.17577,0.05332 -0.34132,0.13591 -0.4897,0.24431c-0.0064,0.0046 -0.01231,0.0097 -0.01787,0.01521c-0.0099,0.01074 -0.01966,0.02057 -0.03574,0.02237c-0.0131,0.00039 -0.02614,-0.0017 -0.03843,-0.0063l-5.19903,-2.21219l-0.0099,-0.0044c-0.03306,-0.01342 -0.07239,-0.02954 -0.07239,-0.06353c-0.03056,-0.29014 -0.12518,-0.56984 -0.27702,-0.81883c-0.02503,-0.04116 -0.05272,-0.08413 -0.03129,-0.12618l3.63357,-5.64059zm-3.51368,7.70148l4.87376,2.06722c0.0268,0.01258 0.0563,0.02416 0.06791,0.0519c0.0047,0.01669 0.0047,0.03432 0,0.05101c-0.01431,0.07159 -0.0268,0.15303 -0.0268,0.23536l0,0.13691c0,0.03401 -0.03485,0.04832 -0.06702,0.06176l-0.0099,0.0035c-0.77208,0.33022 -10.83952,4.62931 -10.85471,4.62931c-0.01519,0 -0.03128,0 -0.04646,-0.01521c-0.0268,-0.02684 0,-0.06444 0.02413,-0.09845c0.0043,-0.0059 0.0084,-0.01192 0.01245,-0.01789l4.00517,-6.21059l0.0072,-0.01074c0.02324,-0.03758 0.05004,-0.07965 0.09293,-0.07965l0.04022,0.0063c0.09115,0.01258 0.17157,0.02415 0.25289,0.02415c0.60766,0 1.17063,-0.29621 1.51021,-0.80272c0.0081,-0.01354 0.01835,-0.02562 0.03038,-0.03581c0.02413,-0.01789 0.05987,-0.0089 0.08757,0.0035l0.00007,0.00014zm-5.5815,8.21964l10.97356,-4.68658c0,0 0.01608,0 0.03128,0.01521c0.05987,0.05996 0.11081,0.10023 0.15995,0.13782l0.02413,0.01521c0.02233,0.01258 0.04469,0.02684 0.04646,0.05012c0,0.0089 0,0.01432 -0.0019,0.02236l-0.94008,5.78283l-0.0035,0.02327c-0.0063,0.04475 -0.01245,0.09576 -0.05451,0.09576c-0.50883,0.0344 -0.96793,0.31802 -1.22693,0.75798l-0.0044,0.0072c-0.01245,0.02059 -0.02413,0.04027 -0.04469,0.05101c-0.01876,0.0089 -0.04289,0.0053 -0.06255,0.00088l-8.75115,-1.80769c-0.0089,-0.0018 -0.13583,-0.46445 -0.14566,-0.46534l-0.00001,-0.00004z" id="path14" />
                    </g>
                    </g>
                    </svg>
                    `
  let enteredToken

  const getSVG = (name) => _find(availableHosts, ['id', name])?.svg || ''
</script>

<div class="boxes">
  {#each $hosts as host}
    <div class="box host-account">
      <div class="user">
        <!-- if the host is netlify then use svg with id hosted netlify  -->
        {#if host.name === 'netlify'}
          {@html netlifyHostedSVG}
        {:else}
          {@html getSVG(host.name)}
        {/if}
      </div>
      <div class="host-user">
        <button
          on:click={() => {
            actions.hosts.delete(host.name)
          }}>Remove</button
        >
        <span class="sr-only">Go to host</span>
      </div>
    </div>
  {/each}
  {#if hostBeingConnected === 'vercel'}
    <div class="box connecting-host">
      <button class="back" on:click={() => (hostBeingConnected = null)}
        >Back to web hosts</button
      >
      <form
        on:submit|preventDefault={async () => {
          await actions.hosts.connect({
            name: 'vercel',
            token: enteredToken,
          })
          hostBeingConnected = null
          showingHosts = false
        }}
        in:fade={{ duration: 200 }}
      >
        <TextField
          bind:value={enteredToken}
          placeholder="7diizPFerd0Isu33ex9aamjT"
          button={{
            label: 'Connect',
            type: 'submit',
          }}
        >
          <p class="title">Vercel</p>
          <p class="subtitle">
            Create and enter a <a
              style="text-decoration:underline"
              target="blank"
              href="https://vercel.com/account/tokens">token</a
            > to finish connecting to your hosting account
          </p>
        </TextField>
        {#if errorMessage}
          <div class="error-message" transition:slide>
            {errorMessage}
          </div>
        {/if}
      </form>
    </div>
  {:else if hostBeingConnected === 'netlify'}
    <div class="box connecting-host">
      <button class="back" on:click={() => (hostBeingConnected = null)}
        >Back to web hosts</button
      >
      <form
        on:submit|preventDefault={async () => {
          await actions.hosts.connect({
            name: 'netlify',
            token: enteredToken,
          })
          hostBeingConnected = null
          showingHosts = false
        }}
        in:fade={{ duration: 200 }}
      >
        <TextField
          bind:value={enteredToken}
          placeholder="7diizPFerd0Isu33ex9aamjT"
          button={{
            label: 'Connect',
            type: 'submit',
          }}
        >
          <p class="title">Netlify</p>
          <p class="subtitle">
            Create and enter a <a
              style="text-decoration:underline"
              target="blank"
              href="https://app.netlify.com/user/applications/personal">token</a
            > to finish connecting to your hosting account
          </p>
        </TextField>
        {#if errorMessage}
          <div class="error-message" transition:slide>
            {errorMessage}
          </div>
        {/if}
      </form>
    </div>
  {:else if hostBeingConnected === 'github'}
    <div class="box connecting-host">
      <button class="back" on:click={() => (hostBeingConnected = null)}
        >Back to web hosts</button
      >
      <div in:fade={{ duration: 200 }}>
        <div>
          <p class="title">Github</p>
          <p class="subtitle">
            Sign in with your Github account to finish connecting it
          </p>
        </div>
        {#if errorMessage}
          <div class="error-message" transition:slide>
            {errorMessage}
          </div>
        {/if}
        <PrimaryButton
          {loading}
          on:click={() => {
            // if ($unsaved) {
            //   window.alert('Please save your work before continuing')
            //   return
            // } else {
            //   window.location.href = `https://github.com/login/oauth/authorize?client_id=${'39b8a7b215c8e8add020'}&scope=public_repo&redirect_uri=${
            //     window.location.href
            //   }`
            // }
          }}
        >
          <i class="fab fa-github" />
          <span style="margin-left:4px">Sign in with Github</span>
        </PrimaryButton>
      </div>
    </div>
  {/if}
  {#if !showingHosts && $hosts.length === 0}
    <footer>
      {#each buttons as button}
        <button class="link" on:click={button.onclick}>{button.label}</button>
      {/each}
      <button class="link" on:click={() => (showingHosts = true)}
        >Connect a host</button
      >
    </footer>
  {:else if !showingHosts}
    <footer>
      {#each buttons as button}
        <button class="link" on:click={button.onclick}>{button.label}</button>
      {/each}
    </footer>
  {:else if showingHosts && !hostBeingConnected}
    <div class="hosts">
      <div class="buttons" in:fade={{ duration: 200 }}>
        {#each availableHosts as host}
          <button
            class={host.id}
            on:click={() => (hostBeingConnected = host.id)}
          >
            {@html getSVG(host.id)}
          </button>
        {/each}
      </div>
    </div>
  {/if}
</div>

<style lang="postcss">
  .link {
    font-size: 0.85rem;
    color: var(--primo-color-gray-4);
    transition: text-decoration-color 0.1s, color 0.1s;
    text-decoration: underline var(--primo-color-gray-4);
    &:hover {
      text-decoration-color: var(--primo-color-primored);
      color: var(--primo-color-primored);
    }
  }
  .title {
    margin-bottom: 0.25rem;
    color: var(--primo-color-gray-1);
    font-weight: 600;
  }
  .subtitle {
    color: var(--primo-color-gray-2);
    margin-bottom: 1rem;
    font-size: var(--font-size-2);
    line-height: 1.5;
    a {
      text-decoration: underline;
      &:hover {
        color: var(--primo-color-primored);
      }
    }
  }
  .box {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    padding: 1rem;
    background: var(--primo-color-codeblack);

    .icon-item {
      i {
        margin-right: 5px;
      }
      a {
        text-decoration: underline;
      }
    }
    .box-footer {
      font-size: 0.75rem;
      color: var(--primo-color-gray-5);
    }
    .user {
      display: grid;
      grid-template-columns: auto 1fr;
      place-items: center;
      gap: 1rem;
    }
    span:first-child {
      font-weight: 700;
    }
    a {
      text-decoration: underline;
    }
    .hosts {
      width: 100%;
      display: grid;
      gap: 0.5rem;
    }
    &.host-account {
      width: 100%;
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: center;
      transition: box-shadow 0.1s;
      border-radius: var(--primo-border-radius);
      margin-bottom: 0.5rem;

      &:hover {
        /* box-shadow: var(--primo-ring-primored); */
      }
      &:not(:last-child) {
        padding-bottom: 1rem;
        border-bottom: 1px solid var(--primo-color-gray-9);
        margin-bottom: 1rem;
      }
    }
    .link {
      align-self: flex-end;
    }
  }
  .boxes {
    display: grid;
    gap: 1rem;

    footer {
      display: flex;
      justify-content: flex-end;
      gap: 1rem;
      text-align: right;
    }
  }
  .buttons {
    display: grid;
    gap: 0.5rem;
    grid-template-columns: 1fr 1fr;
    color: black;

    button {
      background: white;
      padding: 1rem;
      box-shadow: 0 0 0 0 var(--primo-color-primored);
      border-radius: var(--primo-border-radius);
      transition: box-shadow 0.1s;
      overflow: visible;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      svg {
        width: 6rem;
        height: 100%;
        padding: 1rem 0;
      }
      &:not([disabled]):hover {
        box-shadow: 0 0 0 3px var(--primo-color-primored);
      }
      &[disabled] {
        cursor: initial;
        opacity: 0.5;
      }
    }
  }
  .connecting-host {
    padding: 1rem;
    box-shadow: 0 0 0 1px var(--primo-color-primored);
    margin-top: 1rem;
    width: 100%;
    --space-y: 0;

    .back {
      color: var(--primo-color-primored);
      font-size: 0.75rem;
      text-decoration: underline;
      margin-bottom: 0.5rem;
    }
    label {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      margin-bottom: 1rem;

      input {
        border: 0;
        width: 100%;
        background: var(--primo-color-gray-8);
        color: var(--primo-color-gray-1);
      }
    }
  }
</style>
